---
title: "Untitled"
author: "Emily Lachtara"
date: "10/10/2019"
output: html_document
---

```{r setup, include=FALSE}
library(jsonlite)
library(leaflet)
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

###Importing the JSON Valley Bike File
The original JSON file contained more information than we anticipated for the 54 permanent stations: 
"code"                         "locking_station_type"         "sponsor"                     
 "secondary_locked_cycle_count" "id"                           "has_kiosk"                   
 "area"                         "opening_hours"                "schedule"                    
 "area_json"                    "area_type"                    "min_bikes_request_time"      
"installation_date"            "manage_status"                "stocking_high"               
"location"                     "serial_number"                "stocking_full"               
"type"                         "public"                       "status"                      
"station_stocking_status"      "photoid"                      "description"                 
"primary_locked_cycle_count"   "stocking_low"                 "total_locked_cycle_count"    
"free_spaces"                  "docking_station_type"         "cycles_in_station"           
"advertisement"                "address"                      "free_dockes"                 
"has_ccreader"                 "name"                         "notes"                       
"station_type"                 "kiosks"                       "max_extra_bikes"  

We originally looked to the nested DF area for information, but resorted to the location variable for our final table. We retained the arbitrary station serial number(from the website- not us), station name, address, latitude and longitude coordinates, and number of docks.  

```{r}
#IMPORTING JSON FILE FROM WEBSITE
valleybiketable<-fromJSON("https://valleybike.org/stations/stations/")
valleybiketable<-as.data.frame(valleybiketable)


#SELECTING FOR VARIABLES
valleybikedf<-dplyr::select(valleybiketable,  serial_number, address, name, stocking_full, location)

#CLEANING IT UP
stationlocations<-valleybikedf%>%
  separate(location, into=c("Latitude", "Longitude"), sep=",")%>%
  mutate(Longitude = parse_number(Longitude))%>%
  mutate(Latitude= parse_number(Latitude))%>%
  mutate(serial_number =parse_number(serial_number))%>%
  rename(Serial_Num= serial_number, Address=address, Station_Name=name, Num_Docks=stocking_full)
```


We can see here that this table captures all the locations seen on the website. 
```{r}
stationlocations %>%
    leaflet() %>%
    addTiles() %>%
    addMarkers(lng = ~Longitude, lat = ~Latitude)

```